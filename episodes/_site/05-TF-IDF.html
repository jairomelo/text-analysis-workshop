<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TF-IDF: Finding Distinctive Words – Text Analysis with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4622d65869db0eb0c1673d809f0e76d8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="_static/css/styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-TF-IDF.html">5. TF-IDF Analysis</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_static/images/analytics.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.flaticon.com/free-icons/report" title="report icons" target="_blank" class="header-icon-attribution">Report icons created by Freepik - Flaticon</a></figcaption>
</figure>
</div>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Text Analysis with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jairomelo/text-analysis-workshop" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary and Setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basicConcepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Basic Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-CreatingACorpus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Creating a Corpus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-basicTextAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Basic Text Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-textQuality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Text Quality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-TF-IDF.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">5. TF-IDF Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-findingSimilarities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Finding Similarities</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-tf-idf" id="toc-what-is-tf-idf" class="nav-link active" data-scroll-target="#what-is-tf-idf">What is TF-IDF?</a>
  <ul class="collapse">
  <li><a href="#understanding-the-components" id="toc-understanding-the-components" class="nav-link" data-scroll-target="#understanding-the-components">Understanding the Components</a></li>
  </ul></li>
  <li><a href="#setting-up-our-analysis" id="toc-setting-up-our-analysis" class="nav-link" data-scroll-target="#setting-up-our-analysis">Setting Up Our Analysis</a></li>
  <li><a href="#calculating-tf-idf" id="toc-calculating-tf-idf" class="nav-link" data-scroll-target="#calculating-tf-idf">Calculating TF-IDF</a>
  <ul class="collapse">
  <li><a href="#understanding-the-results" id="toc-understanding-the-results" class="nav-link" data-scroll-target="#understanding-the-results">Understanding the Results</a></li>
  </ul></li>
  <li><a href="#visualizing-tf-idf" id="toc-visualizing-tf-idf" class="nav-link" data-scroll-target="#visualizing-tf-idf">Visualizing TF-IDF</a>
  <ul class="collapse">
  <li><a href="#authors-distinctive-vocabularies" id="toc-authors-distinctive-vocabularies" class="nav-link" data-scroll-target="#authors-distinctive-vocabularies">Authors’ Distinctive Vocabularies</a></li>
  <li><a href="#top-tf-idf-terms-by-book" id="toc-top-tf-idf-terms-by-book" class="nav-link" data-scroll-target="#top-tf-idf-terms-by-book">Top TF-IDF Terms by Book</a></li>
  <li><a href="#thematic-words" id="toc-thematic-words" class="nav-link" data-scroll-target="#thematic-words">Thematic Words</a></li>
  <li><a href="#genre-thematic-fingerprints" id="toc-genre-thematic-fingerprints" class="nav-link" data-scroll-target="#genre-thematic-fingerprints">Genre Thematic Fingerprints</a></li>
  <li><a href="#what-genre-analysis-reveals" id="toc-what-genre-analysis-reveals" class="nav-link" data-scroll-target="#what-genre-analysis-reveals">What Genre Analysis Reveals</a></li>
  </ul></li>
  <li><a href="#interpreting-tf-idf-results" id="toc-interpreting-tf-idf-results" class="nav-link" data-scroll-target="#interpreting-tf-idf-results">Interpreting TF-IDF Results</a>
  <ul class="collapse">
  <li><a href="#individual-book-fingerprints" id="toc-individual-book-fingerprints" class="nav-link" data-scroll-target="#individual-book-fingerprints">Individual Book Fingerprints</a></li>
  <li><a href="#genre-level-patterns" id="toc-genre-level-patterns" class="nav-link" data-scroll-target="#genre-level-patterns">Genre-Level Patterns</a></li>
  <li><a href="#what-these-patterns-reveal" id="toc-what-these-patterns-reveal" class="nav-link" data-scroll-target="#what-these-patterns-reveal">What These Patterns Reveal</a></li>
  <li><a href="#practical-applications" id="toc-practical-applications" class="nav-link" data-scroll-target="#practical-applications">Practical Applications</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TF-IDF: Finding Distinctive Words</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the previous chapter, we explored basic text analysis techniques like word frequencies and lexical density. While these methods help us understand general patterns in our texts, they don’t tell us which words are truly distinctive or characteristic of specific authors, genres, or time periods.</p>
<p>This is where <strong>TF-IDF (Term Frequency-Inverse Document Frequency)</strong> becomes invaluable. TF-IDF helps us identify words that are not only frequent in a particular document, but also relatively rare across the entire corpus. This makes it an excellent tool for discovering what makes each text unique.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Why TF-IDF Matters">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why TF-IDF Matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>While simple word frequency tells us what words appear most often, TF-IDF tells us what words are most <em>characteristic</em> of a document. A word like “the” might be very frequent, but it appears in all documents. However, a word like “Darcy” might be moderately frequent in Pride and Prejudice but appear nowhere else in our corpus, making it highly characteristic of that specific novel.</p>
</div>
</div>
<section id="what-is-tf-idf" class="level2">
<h2 class="anchored" data-anchor-id="what-is-tf-idf">What is TF-IDF?</h2>
<p>TF-IDF combines two important concepts:</p>
<ul>
<li><strong>Term Frequency (TF)</strong>: How often a word appears in a specific document</li>
<li><strong>Inverse Document Frequency (IDF)</strong>: How rare the word is across all documents in the corpus</li>
</ul>
<p>The mathematical formula is:</p>
<p><span class="math display">\[
\text{TF-IDF}(t,d) = \text{TF}(t,d) \times \text{IDF}(t)
\]</span></p>
<p>Where: - <span class="math inline">\(\text{TF}(t,d)\)</span> = frequency of term <span class="math inline">\(t\)</span> in document <span class="math inline">\(d\)</span> - <span class="math inline">\(\text{IDF}(t) = \log\left(\frac{\text{Total documents}}{\text{Documents containing } t}\right)\)</span></p>
<section id="understanding-the-components" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-components">Understanding the Components</h3>
<p><strong>Term Frequency (TF)</strong> can be calculated in several ways: - Raw count: Simply how many times the word appears - Relative frequency: Raw count divided by total words in the document - Log normalization: <span class="math inline">\(1 + \log(\text{raw count})\)</span> (used to dampen the effect of very high frequencies)</p>
<p><strong>Inverse Document Frequency (IDF)</strong> gives higher weights to words that appear in fewer documents: - If a word appears in all documents, IDF approaches 0 - If a word appears in only one document, IDF is at its maximum - The logarithm smooths this relationship</p>
<p>Let’s explore this with our corpus!</p>
</section>
</section>
<section id="setting-up-our-analysis" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-our-analysis">Setting Up Our Analysis</h2>
<p>Let’s work with our full corpus from the previous chapter, treating each book as a separate document for TF-IDF analysis. We’ll handle possessive forms by removing the ’s suffix during tokenization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create our full corpus (25 classic works)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>author, <span class="sc">~</span>title, <span class="sc">~</span>year, <span class="sc">~</span>glID, <span class="sc">~</span>genre,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jane Austen"</span>, <span class="st">"Pride and Prejudice"</span>, <span class="dv">1813</span>, <span class="dv">1342</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charles Dickens"</span>, <span class="st">"A Tale of Two Cities"</span>, <span class="dv">1859</span>, <span class="dv">98</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"F. Scott Fitzgerald"</span>, <span class="st">"The Great Gatsby"</span>, <span class="dv">1925</span>, <span class="dv">64317</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mary Wollstonecraft Shelley"</span>, <span class="st">"Frankenstein; Or, The Modern Prometheus"</span>, <span class="dv">1818</span>, <span class="dv">84</span>, <span class="st">"Gothic"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Herman Melville"</span>, <span class="st">"Moby Dick"</span>, <span class="dv">1851</span>, <span class="dv">2701</span>, <span class="st">"Adventure"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Louisa May Alcott"</span>, <span class="st">"Little Women"</span>, <span class="dv">1868</span>, <span class="dv">37106</span>, <span class="st">"Domestic Fiction"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mark Twain"</span>, <span class="st">"Tom Sawyer"</span>, <span class="dv">1876</span>, <span class="dv">74</span>, <span class="st">"Adventure"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jonathan Swift"</span>, <span class="st">"Gulliver's Travels"</span>, <span class="dv">1726</span>, <span class="dv">17157</span>, <span class="st">"Satirical Fiction"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E. M. Forster"</span>, <span class="st">"A Room with a View"</span>, <span class="dv">1908</span>, <span class="dv">2641</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elizabeth Von Arnim"</span>, <span class="st">"The Enchanted April"</span>, <span class="dv">1922</span>, <span class="dv">16389</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Lewis Carroll"</span>, <span class="st">"Alice's Adventures in Wonderland"</span>, <span class="dv">1865</span>, <span class="dv">11</span>, <span class="st">"Fantasy"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elizabeth Gaskell"</span>, <span class="st">"Cranford"</span>, <span class="dv">1853</span>, <span class="dv">394</span>, <span class="st">"Domestic Fiction"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charles Dickens"</span>, <span class="st">"The Pickwick Papers"</span>, <span class="dv">1836</span>, <span class="dv">580</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"J. M. Barrie"</span>, <span class="st">"Peter Pan"</span>, <span class="dv">1911</span>, <span class="dv">16</span>, <span class="st">"Fantasy"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charles Dickens"</span>, <span class="st">"Great Expectations"</span>, <span class="dv">1861</span>, <span class="dv">1400</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Robert Louis Stevenson"</span>, <span class="st">"Treasure Island"</span>, <span class="dv">1883</span>, <span class="dv">120</span>, <span class="st">"Adventure"</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Kenneth Grahame"</span>, <span class="st">"The Wind in the Willows"</span>, <span class="dv">1908</span>, <span class="dv">27805</span>, <span class="st">"Fantasy"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jules Verne"</span>, <span class="st">"Twenty Thousand Leagues Under the Seas"</span>, <span class="dv">1870</span>, <span class="dv">2488</span>, <span class="st">"Science Fiction"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jules Verne"</span>, <span class="st">"A Journey to the Centre of the Earth"</span>, <span class="dv">1864</span>, <span class="dv">18857</span>, <span class="st">"Science Fiction"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jules Verne"</span>, <span class="st">"Around the World in Eighty Days"</span>, <span class="dv">1873</span>, <span class="dv">103</span>, <span class="st">"Adventure"</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bram Stoker"</span>, <span class="st">"Dracula"</span>, <span class="dv">1897</span>, <span class="dv">521</span>, <span class="st">"Gothic"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"H. G. Wells"</span>, <span class="st">"The Time Machine"</span>, <span class="dv">1895</span>, <span class="dv">43</span>, <span class="st">"Science Fiction"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charlotte Brontë"</span>, <span class="st">"Jane Eyre"</span>, <span class="dv">1847</span>, <span class="dv">145</span>, <span class="st">"Gothic"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jane Austen"</span>, <span class="st">"Northanger Abbey"</span>, <span class="dv">1817</span>, <span class="dv">829</span>, <span class="st">"Social Fiction"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elizabeth Gaskell"</span>, <span class="st">"North and South"</span>, <span class="dv">1855</span>, <span class="dv">203</span>, <span class="st">"Social Fiction"</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and clean the texts</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>corpus_texts <span class="ot">&lt;-</span> corpus <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">map</span>(glID, <span class="sc">~</span><span class="fu">gutenberg_download</span>(.x) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pull</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>   <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">" "</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_clean =</span> <span class="fu">str_to_lower</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>       <span class="fu">str_remove_all</span>(<span class="st">"'s</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">%&gt;%</span>                    <span class="co"># Remove possessive 's from full text</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>       <span class="fu">str_remove_all</span>(<span class="st">"[[:punct:]]"</span>) <span class="sc">%&gt;%</span>              <span class="co"># Remove remaining punctuation</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>       <span class="fu">str_squish</span>()                                    <span class="co"># Remove extra whitespace</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(author, title, year, genre, text_clean)  <span class="co"># Keep all metadata columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Determining mirror for Project Gutenberg from
https://www.gutenberg.org/robot/harvest.
Using mirror http://aleph.gutenberg.org.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>corpus_texts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 5
   author                      title                       year genre text_clean
   &lt;chr&gt;                       &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     
 1 Jane Austen                 Pride and Prejudice         1813 Soci… george al…
 2 Charles Dickens             A Tale of Two Cities        1859 Soci… a tale of…
 3 F. Scott Fitzgerald         The Great Gatsby            1925 Soci… the great…
 4 Mary Wollstonecraft Shelley Frankenstein; Or, The Mod…  1818 Goth… frankenst…
 5 Herman Melville             Moby Dick                   1851 Adve… mobydick …
 6 Louisa May Alcott           Little Women                1868 Dome… illustrat…
 7 Mark Twain                  Tom Sawyer                  1876 Adve… the adven…
 8 Jonathan Swift              Gulliver's Travels          1726 Sati… gulliver …
 9 E. M. Forster               A Room with a View          1908 Soci… illustrat…
10 Elizabeth Von Arnim         The Enchanted April         1922 Soci… illustrat…
# ℹ 15 more rows</code></pre>
</div>
</div>
</section>
<section id="calculating-tf-idf" class="level2">
<h2 class="anchored" data-anchor-id="calculating-tf-idf">Calculating TF-IDF</h2>
<p>The <code>tidytext</code> package makes calculating TF-IDF straightforward with the <code>bind_tf_idf()</code> function. Let’s start by tokenizing our corpus and preparing it for TF-IDF analysis.</p>
<p>To improve our thematic analysis, we’ll also apply <strong>lemmatization</strong> - a process that reduces words to their base forms (e.g., “whales” → “whale”, “running” → “run”). This helps us treat related word forms as the same concept, providing cleaner thematic patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize and prepare for TF-IDF with lemmatization</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>corpus_words <span class="ot">&lt;-</span> corpus_texts <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(title, author, genre, text_clean) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text_clean) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply lemmatization to reduce words to their base forms</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">lemmatize_words</span>(word)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(title, word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the structure</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>corpus_words <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   title               word          n
   &lt;chr&gt;               &lt;chr&gt;     &lt;int&gt;
 1 The Pickwick Papers pickwick   2346
 2 The Pickwick Papers sir        1474
 3 Little Women        jo         1412
 4 Moby Dick           whale      1359
 5 The Pickwick Papers sam        1194
 6 The Pickwick Papers reply      1097
 7 The Pickwick Papers weller      987
 8 The Pickwick Papers gentleman   983
 9 Cranford            miss        869
10 Jane Eyre           lydgate     858</code></pre>
</div>
</div>
<p>Now let’s calculate TF-IDF scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate TF-IDF</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>corpus_tfidf <span class="ot">&lt;-</span> corpus_words <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(word, title, n)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the words with highest TF-IDF scores</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 6
   title                            word             n      tf   idf tf_idf
   &lt;chr&gt;                            &lt;chr&gt;        &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Alice's Adventures in Wonderland alice          770 0.0489   2.53 0.124 
 2 Peter Pan                        wendy          332 0.0223   3.22 0.0717
 3 Around the World in Eighty Days  fogg           601 0.0243   2.53 0.0615
 4 Around the World in Eighty Days  passepartout   402 0.0163   3.22 0.0524
 5 The Time Machine                 utterson       127 0.0152   3.22 0.0490
 6 The Enchanted April              wilkins        457 0.0193   2.53 0.0487
 7 Cranford                         matty          345 0.0151   3.22 0.0487
 8 Little Women                     jo            1412 0.0212   2.12 0.0450
 9 The Pickwick Papers              pickwick      2346 0.0208   2.12 0.0440
10 The Great Gatsby                 gatsby         190 0.0111   3.22 0.0356
11 Little Women                     meg            701 0.0105   3.22 0.0339
12 The Enchanted April              fisher         373 0.0158   2.12 0.0334
13 Around the World in Eighty Days  phileas        255 0.0103   3.22 0.0332
14 The Enchanted April              arbuthnot      239 0.0101   3.22 0.0325
15 Pride and Prejudice              darcy          380 0.00990  3.22 0.0319
16 The Time Machine                 jekyll          82 0.00982  3.22 0.0316
17 A Room with a View               lucy           437 0.0195   1.61 0.0314
18 Little Women                     laurie         613 0.00922  3.22 0.0297
19 Jane Eyre                        lydgate        858 0.00860  3.22 0.0277
20 The Wind in the Willows          toad           444 0.0217   1.27 0.0277</code></pre>
</div>
</div>
<p>Let’s examine what these high TF-IDF words tell us about each book:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top TF-IDF words for each book</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>top_tfidf <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>top_tfidf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 251 × 6
   title                                word           n      tf   idf  tf_idf
   &lt;chr&gt;                                &lt;chr&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 A Journey to the Centre of the Earth hans         168 0.00545 2.53  0.0138 
 2 A Journey to the Centre of the Earth uncle        502 0.0163  0.446 0.00727
 3 A Journey to the Centre of the Earth sneffels      49 0.00159 3.22  0.00512
 4 A Journey to the Centre of the Earth professor    184 0.00597 0.734 0.00438
 5 A Journey to the Centre of the Earth hardwigg      41 0.00133 3.22  0.00428
 6 A Journey to the Centre of the Earth saknussemm    41 0.00133 3.22  0.00428
 7 A Journey to the Centre of the Earth iceland       48 0.00156 2.53  0.00393
 8 A Journey to the Centre of the Earth lava          49 0.00159 2.12  0.00337
 9 A Journey to the Centre of the Earth granite       53 0.00172 1.83  0.00315
10 A Journey to the Centre of the Earth raft          88 0.00285 1.02  0.00292
# ℹ 241 more rows</code></pre>
</div>
</div>
<section id="understanding-the-results" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-results">Understanding the Results</h3>
<p>Let’s examine what these distinctive words reveal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display top words by book in a more readable format</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>top_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(title, word, tf_idf) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tf_idf =</span> <span class="fu">round</span>(tf_idf, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_words =</span> <span class="fu">paste</span>(word, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 2
   title                                   top_words                            
   &lt;chr&gt;                                   &lt;chr&gt;                                
 1 A Journey to the Centre of the Earth    hans, uncle, sneffels, professor, ha…
 2 A Room with a View                      lucy, bartlett, cecil, honeychurch, …
 3 A Tale of Two Cities                    lorry, defarge, carton, manette, pro…
 4 Alice's Adventures in Wonderland        alice, gryphon, hatter, dormouse, du…
 5 Around the World in Eighty Days         fogg, passepartout, phileas, aouda, …
 6 Cranford                                matty, cranford, jenkyns, jamieson, …
 7 Dracula                                 xury, friday, canoe, brazils, island…
 8 Frankenstein; Or, The Modern Prometheus clerval, justine, felix, frankenstei…
 9 Great Expectations                      joe, wemmick, havisham, estella, her…
10 Gulliver's Travels                      glumdalclitch, blefuscu, majesty, em…
# ℹ 15 more rows</code></pre>
</div>
</div>
<p>Notice how the top TF-IDF words immediately reveal: - <strong>Character names</strong>: “alice” (Alice’s Adventures in Wonderland), “fogg” and “passepartout” (Around the World in Eighty Days), “matty” (Cranford) - <strong>Setting-specific terms</strong>: “sneffels” (A Journey to the Centre of the Earth), “blefuscu” (Gulliver’s Travels), “brazils” (Adventure novels) - <strong>Genre-specific vocabulary</strong>: Scientific and technical terms in Jules Verne works, fantastical locations in Swift’s satire</p>
</section>
</section>
<section id="visualizing-tf-idf" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-tf-idf">Visualizing TF-IDF</h2>
<p>Rather than standard bar charts, let’s create visualizations that reveal the literary nature of our corpus and help us understand how TF-IDF captures the essence of different works.</p>
<section id="authors-distinctive-vocabularies" class="level3">
<h3 class="anchored" data-anchor-id="authors-distinctive-vocabularies">Authors’ Distinctive Vocabularies</h3>
<p>Let’s examine authors who have multiple works in our corpus to see their consistent vocabulary patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on authors with multiple works</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>multi_work_authors <span class="ot">&lt;-</span> corpus <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(author, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(author)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top TF-IDF words for these authors' works</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>author_vocabulary <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(corpus <span class="sc">%&gt;%</span> <span class="fu">select</span>(title, author), <span class="at">by =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author <span class="sc">%in%</span> multi_work_authors) <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(author, title) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a combined identifier for better plotting</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">work_id =</span> <span class="fu">paste</span>(<span class="fu">str_wrap</span>(author, <span class="dv">15</span>), <span class="st">"-"</span>, <span class="fu">str_trunc</span>(title, <span class="dv">20</span>)))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>author_vocabulary <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder_within</span>(word, tf_idf, work_id), <span class="at">y =</span> tf_idf, <span class="at">fill =</span> author)) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>work_id, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Authors' Distinctive Words Across Multiple Works"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Do authors maintain consistent vocabulary patterns?"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Distinctive Words"</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"TF-IDF Score"</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Author"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-TF-IDF_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="top-tf-idf-terms-by-book" class="level3">
<h3 class="anchored" data-anchor-id="top-tf-idf-terms-by-book">Top TF-IDF Terms by Book</h3>
<p>Before diving into systematic analysis, let’s create a simple reference list of the top 10 TF-IDF terms for each book:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a clean reference list of top TF-IDF terms</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>top_terms_by_book <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_10_terms =</span> <span class="fu">paste</span>(word, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(title)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display as a clean table</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>top_terms_by_book <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_trunc</span>(title, <span class="dv">35</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_10_terms =</span> <span class="fu">str_wrap</span>(top_10_terms, <span class="dv">60</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Book Title"</span>, <span class="st">"Top 10 TF-IDF Terms"</span>),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Most distinctive words for each book in our corpus"</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Most distinctive words for each book in our corpus</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 74%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Book Title</th>
<th style="text-align: left;">Top 10 TF-IDF Terms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A Journey to the Centre of the E…</td>
<td style="text-align: left;">hans, uncle, sneffels, professor, hardwigg, saknussemm,</td>
</tr>
<tr class="even">
<td style="text-align: left;">iceland, lava, granite, raft</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A Room with a View</td>
<td style="text-align: left;">lucy, bartlett, cecil, honeychurch, beebe, freddy, emerson,</td>
</tr>
<tr class="even">
<td style="text-align: left;">charlotte, vyse, florence</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A Tale of Two Cities</td>
<td style="text-align: left;">lorry, defarge, carton, manette, pross, darnay, lucie,</td>
</tr>
<tr class="even">
<td style="text-align: left;">cruncher, monseigneur, stryver</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alice’s Adventures in Wonderland</td>
<td style="text-align: left;">alice, gryphon, hatter, dormouse, duchess, turtle,</td>
</tr>
<tr class="even">
<td style="text-align: left;">caterpillar, alices, rabbit, mouse</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Around the World in Eighty Days</td>
<td style="text-align: left;">fogg, passepartout, phileas, aouda, hong, kong, detective,</td>
</tr>
<tr class="even">
<td style="text-align: left;">yokohama, bombay, foggs</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cranford</td>
<td style="text-align: left;">matty, cranford, jenkyns, jamieson, glenmire, forrester,</td>
</tr>
<tr class="even">
<td style="text-align: left;">mattys, hoggins, deborah, jessie</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dracula</td>
<td style="text-align: left;">xury, friday, canoe, brazils, island, ship, boat,</td>
</tr>
<tr class="even">
<td style="text-align: left;">deliverance, shore, rice</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frankenstein; Or, The Modern Pro…</td>
<td style="text-align: left;">clerval, justine, felix, frankenstein, safie, elizabeth,</td>
</tr>
<tr class="even">
<td style="text-align: left;">geneva, agatha, dæmon, ingolstadt</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Great Expectations</td>
<td style="text-align: left;">joe, wemmick, havisham, estella, herbert, pip, jaggers,</td>
</tr>
<tr class="even">
<td style="text-align: left;">biddy, pumblechook, wopsle</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gulliver’s Travels</td>
<td style="text-align: left;">glumdalclitch, blefuscu, majesty, emperor, lilliput, cent,</td>
</tr>
<tr class="even">
<td style="text-align: left;">edit, manmountain, honor, imperial</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jane Eyre</td>
<td style="text-align: left;">lydgate, dorothea, casaubon, bulstrode, rosamond, fred,</td>
</tr>
<tr class="even">
<td style="text-align: left;">garth, brooke, middlemarch, celia</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Little Women</td>
<td style="text-align: left;">jo, meg, laurie, amy, beth, laurence, hannah, bhaer, brooke,</td>
</tr>
<tr class="even">
<td style="text-align: left;">teddy</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moby Dick</td>
<td style="text-align: left;">whale, ahab, stubb, queequeg, sperm, starbuck, pequod,</td>
</tr>
<tr class="even">
<td style="text-align: left;">nantucket, leviathan, harpoon</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">North and South</td>
<td style="text-align: left;">eva, clare, legree, ophelia, haley, masr, cassy, shelby,</td>
</tr>
<tr class="even">
<td style="text-align: left;">tom, yer</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Northanger Abbey</td>
<td style="text-align: left;">yahoos, houyhnhnms, yahoo, glumdalclitch, majestys,</td>
</tr>
<tr class="even">
<td style="text-align: left;">blefuscu, majesty, emperor, houyhnhnm, luggnagg</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Peter Pan</td>
<td style="text-align: left;">wendy, peter, nana, smee, michael, tootle, redskin, nib,</td>
</tr>
<tr class="even">
<td style="text-align: left;">tink, wendys</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pride and Prejudice</td>
<td style="text-align: left;">darcy, bennet, bingley, elizabeth, wickham, lydia, collins,</td>
</tr>
<tr class="even">
<td style="text-align: left;">jane, longbourn, netherfield</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Enchanted April</td>
<td style="text-align: left;">wilkins, fisher, arbuthnot, caroline, briggs, lotty,</td>
</tr>
<tr class="even">
<td style="text-align: left;">salvatore, mellersh, frederick, fishers, francesca</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Great Gatsby</td>
<td style="text-align: left;">gatsby, daisy, gatsbys, wilson, daisys, car, tom, jordan,</td>
</tr>
<tr class="even">
<td style="text-align: left;">garage, wolfshiem</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Pickwick Papers</td>
<td style="text-align: left;">pickwick, weller, sam, winkle, wardle, tupman, perker, wery,</td>
</tr>
<tr class="even">
<td style="text-align: left;">pott, bardell</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Time Machine</td>
<td style="text-align: left;">utterson, jekyll, hyde, poole, lanyon, lawyer, jekylls,</td>
</tr>
<tr class="even">
<td style="text-align: left;">enfield, dr, edward</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Wind in the Willows</td>
<td style="text-align: left;">toad, mole, badger, rat, ratty, otter, motorcar, bargewoman,</td>
</tr>
<tr class="even">
<td style="text-align: left;">gipsy, stoat</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tom Sawyer</td>
<td style="text-align: left;">huck, tom, becky, sid, injun, joe, thatcher, aint, harper,</td>
</tr>
<tr class="even">
<td style="text-align: left;">polly</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treasure Island</td>
<td style="text-align: left;">livesey, jim, hispaniola, capn, squire, hawkins, smollett,</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunn, trelawney, stockade</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Twenty Thousand Leagues Under th…</td>
<td style="text-align: left;">conseil, nemo, nautilus, ned, meter, canadian, nautiluss,</td>
</tr>
<tr class="even">
<td style="text-align: left;">underwater, aronnax, whale</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table above clearly shows that <strong>character names dominate TF-IDF results in literature</strong>. Looking at the terms, we can manually identify character names to separate them from thematic words for deeper analysis.</p>
</section>
<section id="thematic-words" class="level3">
<h3 class="anchored" data-anchor-id="thematic-words">Thematic Words</h3>
<p>Now let’s focus on the distinctive words that aren’t character names, to discover the thematic fingerprint of each work. We’ll create a comprehensive list of character names to exclude from our analysis:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This list was created manually by identifying character names in the text that appeared as results in the table above and in the subsequent thematic fingerprint results. The process was repeated until we achieved this comprehensive list.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive list of character names</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>character_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darcy"</span>, <span class="st">"bennet"</span>, <span class="st">"bingley"</span>, <span class="st">"elizabeth"</span>, <span class="st">"wickham"</span>, <span class="st">"lydia"</span>, <span class="st">"collins"</span>, <span class="st">"jane"</span>, <span class="st">"alice"</span>, <span class="st">"gryphon"</span>, <span class="st">"hatter"</span>, <span class="st">"turtle"</span>, <span class="st">"dormouse"</span>, <span class="st">"duchess"</span>, <span class="st">"caterpillar"</span>, <span class="st">"rabbit"</span>, <span class="st">"mouse"</span>, <span class="st">"francis"</span>, <span class="st">"huckleberry"</span>, <span class="st">"sawyer"</span>, <span class="st">"potter"</span>, <span class="st">"joe"</span>, <span class="st">"ben"</span>, <span class="st">"cranford"</span>, <span class="st">"martha"</span>, <span class="st">"jamieson"</span>, <span class="st">"matilda"</span>, <span class="st">"teddy"</span>, <span class="st">"beth"</span>, <span class="st">"meg"</span>, <span class="st">"demi"</span>, <span class="st">"laurie"</span>, <span class="st">"gatsby"</span>, <span class="st">"daisy"</span>, <span class="st">"tom"</span>, <span class="st">"jordan"</span>, <span class="st">"wilson"</span>, <span class="st">"wolfshiem"</span>, <span class="st">"hans"</span>, <span class="st">"lucy"</span>, <span class="st">"bartlett"</span>, <span class="st">"cecil"</span>, <span class="st">"honeychurch"</span>, <span class="st">"beebe"</span>, <span class="st">"freddy"</span>, <span class="st">"emerson"</span>, <span class="st">"vyse"</span>, <span class="st">"charlotte"</span>, <span class="st">"lorry"</span>, <span class="st">"defarge"</span>, <span class="st">"manette"</span>, <span class="st">"pross"</span>, <span class="st">"darnay"</span>, <span class="st">"lucie"</span>, <span class="st">"carton"</span>, <span class="st">"cruncher"</span>, <span class="st">"stryver"</span>, <span class="st">"fogg"</span>, <span class="st">"passepartout"</span>, <span class="st">"phileas"</span>, <span class="st">"aouda"</span>, <span class="st">"foggs"</span>, <span class="st">"matty"</span>, <span class="st">"jenkyns"</span>, <span class="st">"glenmire"</span>, <span class="st">"forrester"</span>, <span class="st">"mattys"</span>, <span class="st">"hoggins"</span>, <span class="st">"deborah"</span>, <span class="st">"jessie"</span>, <span class="st">"helsing"</span>, <span class="st">"mina"</span>, <span class="st">"jonathan"</span>, <span class="st">"harker"</span>, <span class="st">"van"</span>, <span class="st">"godalming"</span>, <span class="st">"seward"</span>, <span class="st">"quincey"</span>, <span class="st">"harkers"</span>, <span class="st">"clerval"</span>, <span class="st">"justine"</span>, <span class="st">"felix"</span>, <span class="st">"frankenstein"</span>, <span class="st">"safie"</span>, <span class="st">"agatha"</span>, <span class="st">"wemmick"</span>, <span class="st">"havisham"</span>, <span class="st">"estella"</span>, <span class="st">"biddy"</span>, <span class="st">"jaggers"</span>, <span class="st">"herbert"</span>, <span class="st">"pip"</span>, <span class="st">"pumblechook"</span>, <span class="st">"wopsle"</span>, <span class="st">"glumdalclitch"</span>, <span class="st">"rochester"</span>, <span class="st">"adèle"</span>, <span class="st">"eyre"</span>, <span class="st">"fairfax"</span>, <span class="st">"bessie"</span>, <span class="st">"ingram"</span>, <span class="st">"reed"</span>, <span class="st">"jo"</span>, <span class="st">"amy"</span>, <span class="st">"jos"</span>, <span class="st">"laurence"</span>, <span class="st">"brooke"</span>, <span class="st">"bhaer"</span>, <span class="st">"hannah"</span>, <span class="st">"ahab"</span>, <span class="st">"stubb"</span>, <span class="st">"queequeg"</span>, <span class="st">"starbuck"</span>, <span class="st">"ahabs"</span>, <span class="st">"margaret"</span>, <span class="st">"thornton"</span>, <span class="st">"hale"</span>, <span class="st">"dixon"</span>, <span class="st">"margarets"</span>, <span class="st">"edith"</span>, <span class="st">"higgins"</span>, <span class="st">"lennox"</span>, <span class="st">"catherine"</span>, <span class="st">"tilney"</span>, <span class="st">"morland"</span>, <span class="st">"thorpe"</span>, <span class="st">"isabella"</span>, <span class="st">"allen"</span>, <span class="st">"eleanor"</span>, <span class="st">"catherines"</span>, <span class="st">"tilneys"</span>, <span class="st">"thorpes"</span>, <span class="st">"wendy"</span>, <span class="st">"peter"</span>, <span class="st">"nana"</span>, <span class="st">"michael"</span>, <span class="st">"smee"</span>, <span class="st">"tootles"</span>, <span class="st">"nibs"</span>, <span class="st">"tink"</span>, <span class="st">"wendys"</span>, <span class="st">"starkey"</span>, <span class="st">"wilkins"</span>, <span class="st">"fisher"</span>, <span class="st">"arbuthnot"</span>, <span class="st">"caroline"</span>, <span class="st">"briggs"</span>, <span class="st">"lotty"</span>, <span class="st">"salvatore"</span>, <span class="st">"mellersh"</span>, <span class="st">"frederick"</span>, <span class="st">"scrap"</span>, <span class="st">"pickwick"</span>, <span class="st">"weller"</span>, <span class="st">"winkle"</span>, <span class="st">"sam"</span>, <span class="st">"wardle"</span>, <span class="st">"tupman"</span>, <span class="st">"pickwicks"</span>, <span class="st">"perker"</span>, <span class="st">"snodgrass"</span>, <span class="st">"pott"</span>, <span class="st">"weena"</span>, <span class="st">"psychologist"</span>, <span class="st">"filby"</span>, <span class="st">"toad"</span>, <span class="st">"mole"</span>, <span class="st">"badger"</span>, <span class="st">"rat"</span>, <span class="st">"ratty"</span>, <span class="st">"toads"</span>, <span class="st">"huck"</span>, <span class="st">"becky"</span>, <span class="st">"sid"</span>, <span class="st">"injun"</span>, <span class="st">"thatcher"</span>, <span class="st">"toms"</span>, <span class="st">"harper"</span>, <span class="st">"jim"</span>, <span class="st">"livesey"</span>, <span class="st">"hawkins"</span>, <span class="st">"trelawney"</span>, <span class="st">"conseil"</span>, <span class="st">"nemo"</span>, <span class="st">"ned"</span>, <span class="st">"aronnax"</span>, <span class="st">"eva"</span>, <span class="st">"clare"</span>, <span class="st">"legree"</span>, <span class="st">"ophelia"</span>, <span class="st">"haley"</span>, <span class="st">"cassy"</span>, <span class="st">"shelby"</span>, <span class="st">"topsy"</span>, <span class="st">"morgan"</span>, <span class="st">"diana"</span>, <span class="st">"helen"</span>, <span class="st">"mason"</span>, <span class="st">"saknussemm"</span>, <span class="st">"hardwigg"</span>, <span class="st">"emersons"</span>, <span class="st">"alans"</span>, <span class="st">"minnie"</span>, <span class="st">"lucys"</span>, <span class="st">"bertolini"</span>, <span class="st">"cecils"</span>, <span class="st">"jerry"</span>, <span class="st">"tellsons"</span>, <span class="st">"jacques"</span>, <span class="st">"marquis"</span>, <span class="st">"antoine"</span>, <span class="st">"havishams"</span>, <span class="st">"drummle"</span>, <span class="st">"handel"</span>, <span class="st">"orlick"</span>, <span class="st">"compeyson"</span>, <span class="st">"joes"</span>, <span class="st">"gargery"</span>, <span class="st">"milton"</span>, <span class="st">"helstone"</span>, <span class="st">"bessy"</span>, <span class="st">"thorntons"</span>, <span class="st">"hales"</span>, <span class="st">"shaw"</span>, <span class="st">"boucher"</span>, <span class="st">"northanger"</span>, <span class="st">"fullerton"</span>, <span class="st">"morlands"</span>, <span class="st">"allens"</span>, <span class="st">"henry"</span>, <span class="st">"woodston"</span>, <span class="st">"isabellas"</span>, <span class="st">"francesca"</span>, <span class="st">"meryton"</span>, <span class="st">"pemberley"</span>, <span class="st">"bingleys"</span>, <span class="st">"domenico"</span>, <span class="st">"wilkinss"</span>, <span class="st">"kate"</span>, <span class="st">"costanza"</span>, <span class="st">"gatsbys"</span>, <span class="st">"daisys"</span>, <span class="st">"buchanan"</span>, <span class="st">"michaelis"</span>, <span class="st">"mckee"</span>, <span class="st">"bardell"</span>, <span class="st">"sammy"</span>, <span class="st">"dodson"</span>, <span class="st">"bob"</span>, <span class="st">"arabella"</span>, <span class="st">"masr"</span>, <span class="st">"chloe"</span>, <span class="st">"marie"</span>, <span class="st">"eliza"</span>, <span class="st">"andy"</span>, <span class="st">"emmeline"</span>, <span class="st">"polly"</span>, <span class="st">"hucks"</span>, <span class="st">"alices"</span>, <span class="st">"jamiesons"</span>, <span class="st">"sallie"</span>, <span class="st">"marmee"</span>, <span class="st">"fred"</span>, <span class="st">"hook"</span>, <span class="st">"sewards"</span>, <span class="st">"morris"</span>, <span class="st">"arthur"</span>, <span class="st">"renfield"</span>, <span class="st">"victor"</span>, <span class="st">"rochesters"</span>, <span class="st">"georgiana"</span>, <span class="st">"gretchen"</span>, <span class="st">"alan"</span>, <span class="st">"cissie"</span>, <span class="st">"sydney"</span>, <span class="st">"fanny"</span>, <span class="st">"kitty"</span>, <span class="st">"lizzy"</span>, <span class="st">"james"</span>, <span class="st">"henrys"</span>, <span class="st">"myrtle"</span>, <span class="st">"baker"</span>, <span class="st">"cody"</span>, <span class="st">"trotter"</span>, <span class="st">"jingle"</span>, <span class="st">"augustine"</span>, <span class="st">"phineas"</span>, <span class="st">"estellas"</span>, <span class="st">"jaggerss"</span>, <span class="st">"wemmicks"</span>, <span class="st">"darcys"</span>, <span class="st">"lottys"</span>, <span class="st">"arbuthnots"</span>, <span class="st">"bartletts"</span>, <span class="st">"beebes"</span>, <span class="st">"leonards"</span>, <span class="st">"dixons"</span>, <span class="st">"lucas"</span>, <span class="st">"droitwiches"</span>, <span class="st">"bildad"</span>, <span class="st">"beckys"</span>, <span class="st">"redruth"</span>, <span class="st">"jem"</span>, <span class="st">"dinah"</span>, <span class="st">"westenra"</span>, <span class="st">"eshton"</span>, <span class="st">"sophie"</span>, <span class="st">"harry"</span>, <span class="st">"lorrys"</span>, <span class="st">"pumblechooks"</span>, <span class="st">"trabbs"</span>, <span class="st">"eleanors"</span>, <span class="st">"lydias"</span>, <span class="st">"bennets"</span>, <span class="st">"bourgh"</span>, <span class="st">"carraway"</span>, <span class="st">"sloane"</span>, <span class="st">"beppo"</span>, <span class="st">"lumley"</span>, <span class="st">"dowler"</span>, <span class="st">"peters"</span>, <span class="st">"peleg"</span>, <span class="st">"arley"</span>, <span class="st">"george"</span>, <span class="st">"defarges"</span>, <span class="st">"generals"</span>, <span class="st">"fitzwilliam"</span>, <span class="st">"hurst"</span>, <span class="st">"wickhams"</span>, <span class="st">"briggss"</span>, <span class="st">"gatz"</span>, <span class="st">"adolph"</span>, <span class="st">"poole"</span>, <span class="st">"morton"</span>, <span class="st">"abbot"</span>, <span class="st">"smollett"</span>, <span class="st">"gunn"</span>, <span class="st">"capn"</span>, <span class="st">"holbrook"</span>, <span class="st">"signor"</span>, <span class="st">"fitzadam"</span>, <span class="st">"mulliner"</span>, <span class="st">"brunoni"</span>, <span class="st">"barkers"</span>, <span class="st">"moffat"</span>, <span class="st">"dr"</span>, <span class="st">"andy"</span>, <span class="st">"barker"</span>, <span class="st">"jenkynss"</span>, <span class="st">"forresters"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out character names and get thematic words</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>thematic_tfidf <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> character_names) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add genre information</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(corpus <span class="sc">%&gt;%</span> <span class="fu">select</span>(title, genre), <span class="at">by =</span> <span class="st">"title"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display thematic fingerprints by book</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>thematic_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(title, word, tf_idf, genre) <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_trunc</span>(title, <span class="dv">25</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">tf_idf =</span> <span class="fu">round</span>(tf_idf, <span class="dv">4</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title, genre) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">thematic_words =</span> <span class="fu">paste</span>(word, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_tfidf =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tf_idf), <span class="dv">4</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(genre, title) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Book Title"</span>, <span class="st">"Genre"</span>, <span class="st">"Thematic Words"</span>, <span class="st">"Avg TF-IDF"</span>),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Thematic fingerprints: distinctive non-character words by book"</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Thematic fingerprints: distinctive non-character words by book</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 61%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Book Title</th>
<th style="text-align: left;">Genre</th>
<th style="text-align: left;">Thematic Words</th>
<th style="text-align: right;">Avg TF-IDF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Around the World in Ei…</td>
<td style="text-align: left;">Adventure</td>
<td style="text-align: left;">hong, kong, detective, yokohama, bombay, steamer, carnatic, mongolia</td>
<td style="text-align: right;">0.0054</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moby Dick</td>
<td style="text-align: left;">Adventure</td>
<td style="text-align: left;">whale, sperm, pequod, nantucket, leviathan, harpoon, ye, whaling</td>
<td style="text-align: right;">0.0065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tom Sawyer</td>
<td style="text-align: left;">Adventure</td>
<td style="text-align: left;">aint, aunt, muff, welshman, auntie, hanted, finn, becuz</td>
<td style="text-align: right;">0.0023</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treasure Island</td>
<td style="text-align: left;">Adventure</td>
<td style="text-align: left;">hispaniola, squire, stockade, coracle, benbow, joyce, rum, buccaneer</td>
<td style="text-align: right;">0.0038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cranford</td>
<td style="text-align: left;">Domestic Fiction</td>
<td style="text-align: left;">pole, rector, maam, drumble, miss, jenny, betty, gordon</td>
<td style="text-align: right;">0.0017</td>
</tr>
<tr class="even">
<td style="text-align: left;">Little Women</td>
<td style="text-align: left;">Domestic Fiction</td>
<td style="text-align: left;">1869, tailpiece, 16mo, haf, aunt, grandpa, alcott, flo</td>
<td style="text-align: right;">0.0016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alice’s Adventures in …</td>
<td style="text-align: left;">Fantasy</td>
<td style="text-align: left;">hare, whiting, mock, dodo, lory, soooop, hedgehog, queen</td>
<td style="text-align: right;">0.0030</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peter Pan</td>
<td style="text-align: left;">Fantasy</td>
<td style="text-align: left;">tootle, redskin, nib, pirate, lagoon, neverland, darling, tinker</td>
<td style="text-align: right;">0.0057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Wind in the Willows</td>
<td style="text-align: left;">Fantasy</td>
<td style="text-align: left;">otter, motorcar, bargewoman, gipsy, stoat, washerwoman, weasel, enginedriver, fieldmouse</td>
<td style="text-align: right;">0.0025</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dracula</td>
<td style="text-align: left;">Gothic</td>
<td style="text-align: left;">xury, friday, canoe, brazils, island, ship, boat, deliverance</td>
<td style="text-align: right;">0.0024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frankenstein; Or, The …</td>
<td style="text-align: left;">Gothic</td>
<td style="text-align: left;">geneva, dæmon, ingolstadt, endeavour, kirwin, fiend, cottage, cottager</td>
<td style="text-align: right;">0.0016</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jane Eyre</td>
<td style="text-align: left;">Gothic</td>
<td style="text-align: left;">lydgate, dorothea, casaubon, bulstrode, rosamond, garth, middlemarch, celia</td>
<td style="text-align: right;">0.0158</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gulliver’s Travels</td>
<td style="text-align: left;">Satirical Fiction</td>
<td style="text-align: left;">blefuscu, majesty, emperor, lilliput, cent, edit, manmountain, honor</td>
<td style="text-align: right;">0.0032</td>
</tr>
<tr class="even">
<td style="text-align: left;">A Journey to the Centr…</td>
<td style="text-align: left;">Science Fiction</td>
<td style="text-align: left;">uncle, sneffels, professor, iceland, lava, granite, raft, crater</td>
<td style="text-align: right;">0.0041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Time Machine</td>
<td style="text-align: left;">Science Fiction</td>
<td style="text-align: left;">utterson, jekyll, hyde, lanyon, lawyer, jekylls, enfield, edward</td>
<td style="text-align: right;">0.0172</td>
</tr>
<tr class="even">
<td style="text-align: left;">Twenty Thousand League…</td>
<td style="text-align: left;">Science Fiction</td>
<td style="text-align: left;">nautilus, meter, canadian, nautiluss, underwater, whale, professor, tank</td>
<td style="text-align: right;">0.0076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A Room with a View</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">florence, lavish, italy, croce, tennis, arno, tunbridge, baedeker</td>
<td style="text-align: right;">0.0027</td>
</tr>
<tr class="even">
<td style="text-align: left;">A Tale of Two Cities</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">monseigneur, monsieur, wineshop, madame, evrémonde, barsad, mender, gabelle</td>
<td style="text-align: right;">0.0036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Great Expectations</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">provis, startop, camilla, marsh, skiffins, convict, trabb, walworth</td>
<td style="text-align: right;">0.0018</td>
</tr>
<tr class="even">
<td style="text-align: left;">North and South</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">yer, ar, nigger, missis, thar, ye, dat, sambo</td>
<td style="text-align: right;">0.0033</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Northanger Abbey</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">yahoos, houyhnhnms, yahoo, majestys, blefuscu, majesty, emperor, houyhnhnm, luggnagg</td>
<td style="text-align: right;">0.0038</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pride and Prejudice</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">longbourn, netherfield, gardiner, rosings, hertfordshire, 1894, elizabeths, philips</td>
<td style="text-align: right;">0.0042</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Enchanted April</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">fishers, hampstead, san, mezzago, mediaeval, suitcase, battlements, italy</td>
<td style="text-align: right;">0.0027</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Great Gatsby</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">car, garage, telephone, chicago, phone, coupé, wilsons, biloxi, drugstore</td>
<td style="text-align: right;">0.0030</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Pickwick Papers</td>
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">wery, serjeant, genlmn, pell, stiggins, nupkins, vith, wos</td>
<td style="text-align: right;">0.0028</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Let’s visualize these thematic patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create thematic fingerprint visualization</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>thematic_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Pride and Prejudice"</span>) <span class="sc">~</span> <span class="st">"Pride &amp; Prejudice"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Alice"</span>) <span class="sc">~</span> <span class="st">"Alice in Wonderland"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Great Gatsby"</span>) <span class="sc">~</span> <span class="st">"Great Gatsby"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Frankenstein"</span>) <span class="sc">~</span> <span class="st">"Frankenstein"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Journey.*Centre"</span>) <span class="sc">~</span> <span class="st">"Journey to Earth's Centre"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Twenty Thousand"</span>) <span class="sc">~</span> <span class="st">"20,000 Leagues"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(title, <span class="st">"Around.*World"</span>) <span class="sc">~</span> <span class="st">"Around World in 80 Days"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_trunc</span>(title, <span class="dv">20</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder_within</span>(word, tf_idf, title_short), <span class="at">y =</span> tf_idf, <span class="at">fill =</span> genre)) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>title_short, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Thematic Fingerprints: Distinctive Non-Character Words"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"What themes and concepts define each literary work?"</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Thematic Words"</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"TF-IDF Score"</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Genre"</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-TF-IDF_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="genre-thematic-fingerprints" class="level3">
<h3 class="anchored" data-anchor-id="genre-thematic-fingerprints">Genre Thematic Fingerprints</h3>
<p>Rather than focusing on individual book uniqueness, let’s explore how TF-IDF can reveal the distinctive linguistic signatures of entire literary genres. By analyzing vocabulary patterns across books within each genre, we can identify the “thematic DNA” that characterizes different literary traditions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create genre-level thematic fingerprints</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>genre_fingerprint <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove character names from the analysis</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> character_names) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add genre information</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(corpus <span class="sc">%&gt;%</span> <span class="fu">select</span>(title, genre), <span class="at">by =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate average TF-IDF by genre and word</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre, word) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_tf_idf =</span> <span class="fu">mean</span>(tf_idf),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">books_with_word =</span> <span class="fu">n</span>(),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get top distinctive words per genre</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(avg_tf_idf, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">distinctive_words =</span> <span class="fu">paste</span>(word, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_distinctiveness =</span> <span class="fu">round</span>(<span class="fu">mean</span>(avg_tf_idf), <span class="dv">4</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_distinctiveness))</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(genre_fingerprint, </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Genre"</span>, <span class="st">"Distinctive Vocabulary"</span>, <span class="st">"Avg TF-IDF"</span>),</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Genre thematic fingerprints: the linguistic DNA of literary traditions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Genre thematic fingerprints: the linguistic DNA of literary traditions</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 77%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Genre</th>
<th style="text-align: left;">Distinctive Vocabulary</th>
<th style="text-align: right;">Avg TF-IDF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Science Fiction</td>
<td style="text-align: left;">utterson, jekyll, hyde, nautilus, meter, lanyon, canadian, uncle, nautiluss, lawyer</td>
<td style="text-align: right;">0.0177</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gothic</td>
<td style="text-align: left;">lydgate, dorothea, casaubon, bulstrode, rosamond, garth, middlemarch, celia, ladislaw, vincy</td>
<td style="text-align: right;">0.0141</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adventure</td>
<td style="text-align: left;">whale, hong, kong, hispaniola, sperm, yokohama, pequod, carnatic, mongolia, nantucket</td>
<td style="text-align: right;">0.0076</td>
</tr>
<tr class="even">
<td style="text-align: left;">Social Fiction</td>
<td style="text-align: left;">yahoos, longbourn, monseigneur, houyhnhnms, netherfield, florence, yahoo, garage, fishers, gardiner</td>
<td style="text-align: right;">0.0063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fantasy</td>
<td style="text-align: left;">tootle, redskin, nib, pirate, neverland, otter, darling, tinker, motorcar, whiting</td>
<td style="text-align: right;">0.0051</td>
</tr>
<tr class="even">
<td style="text-align: left;">Satirical Fiction</td>
<td style="text-align: left;">blefuscu, majesty, emperor, lilliput, cent, edit, manmountain, honor, imperial, empress</td>
<td style="text-align: right;">0.0029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Domestic Fiction</td>
<td style="text-align: left;">1869, rector, tailpiece, drumble, 16mo, haf, aunt, gordon, carlo, marthas</td>
<td style="text-align: right;">0.0017</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize genre distinctiveness</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>genre_word_analysis <span class="ot">&lt;-</span> corpus_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> character_names) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(corpus <span class="sc">%&gt;%</span> <span class="fu">select</span>(title, genre), <span class="at">by =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre, word) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_tf_idf =</span> <span class="fu">mean</span>(tf_idf), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(avg_tf_idf, <span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(genre_word_analysis, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder_within</span>(word, avg_tf_idf, genre), </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> avg_tf_idf, <span class="at">fill =</span> genre)) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>genre, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Most Distinctive Words by Literary Genre"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"TF-IDF reveals the vocabulary that defines literary traditions"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Words"</span>, <span class="at">y =</span> <span class="st">"Average TF-IDF Score"</span>) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-TF-IDF_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Genre Vocabulary Patterns">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Genre Vocabulary Patterns
</div>
</div>
<div class="callout-body-container callout-body">
<p>This analysis reveals fascinating patterns in how different literary genres employ distinctive vocabularies:</p>
<ul>
<li><strong>Adventure Fiction</strong>: Geographic terms, maritime vocabulary, and travel-related words</li>
<li><strong>Science Fiction</strong>: Technological terminology, scientific concepts, and futuristic elements</li>
<li><strong>Gothic Literature</strong>: Atmospheric terms, supernatural vocabulary, and dark settings</li>
<li><strong>Social Fiction</strong>: Dialect markers, social terminology, and contemporary references</li>
<li><strong>Fantasy</strong>: Magical terms, mythical vocabulary, and imaginative concepts</li>
</ul>
</div>
</div>
</section>
<section id="what-genre-analysis-reveals" class="level3">
<h3 class="anchored" data-anchor-id="what-genre-analysis-reveals">What Genre Analysis Reveals</h3>
<p>This genre-level TF-IDF analysis demonstrates several important insights:</p>
<ol type="1">
<li><strong>Shared Literary Traditions</strong>: Authors within genres draw from common vocabularies that create recognizable literary voices</li>
<li><strong>Thematic Coherence</strong>: Genre fingerprints reveal not just stylistic choices but fundamental thematic concerns</li>
<li><strong>Reader Expectations</strong>: These vocabulary patterns help explain how readers can often identify genres from brief excerpts</li>
<li><strong>Cultural Evolution</strong>: Genre vocabularies reflect the social, technological, and cultural contexts in which they were written</li>
</ol>
</section>
</section>
<section id="interpreting-tf-idf-results" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-tf-idf-results">Interpreting TF-IDF Results</h2>
<p>Our analysis reveals fascinating patterns in how different books and genres use distinctive vocabulary. Let’s examine the “thematic fingerprints” that TF-IDF has uncovered.</p>
<section id="individual-book-fingerprints" class="level3">
<h3 class="anchored" data-anchor-id="individual-book-fingerprints">Individual Book Fingerprints</h3>
<p>Each book in our corpus has developed its own linguistic signature through distinctive vocabulary:</p>
<p><strong>Science Fiction works</strong> show the highest TF-IDF scores, with technical and fantastical terminology: - <em>Twenty Thousand Leagues Under the Sea</em>: <code>nautilus</code>, <code>meter</code>, <code>canadian</code>, <code>underwater</code> (avg 0.0077) - <em>The Time Machine</em>: <code>morlocks</code>, <code>laboratory</code>, <code>sphinx</code>, <code>eloi</code> (avg 0.0043) - <em>A Journey to the Centre of the Earth</em>: <code>uncle</code>, <code>sneffels</code>, <code>professor</code>, <code>iceland</code> (avg 0.0042)</p>
<p><strong>Adventure novels</strong> feature location-specific and maritime vocabulary: - <em>Moby Dick</em>: <code>whale</code>, <code>sperm</code>, <code>pequod</code>, <code>nantucket</code>, <code>whaling</code> (avg 0.0067) - <em>Around the World in Eighty Days</em>: <code>hong</code>, <code>kong</code>, <code>yokohama</code>, <code>bombay</code>, <code>steamer</code> (avg 0.0054) - <em>Treasure Island</em>: <code>hispaniola</code>, <code>squire</code>, <code>buccaneer</code>, <code>rum</code> (avg 0.0038)</p>
<p><strong>Gothic literature</strong> emphasizes atmospheric and supernatural elements: - <em>Dracula</em>: <code>diary</code>, <code>whitby</code>, <code>undead</code>, <code>carfax</code>, <code>varna</code> (avg 0.0024) - <em>Jane Eyre</em>: <code>thornfield</code>, <code>lowood</code>, <code>brocklehurst</code>, <code>gateshead</code> (avg 0.0021) - <em>Frankenstein</em>: <code>geneva</code>, <code>dæmon</code>, <code>ingolstadt</code>, <code>creator</code> (avg 0.0016)</p>
</section>
<section id="genre-level-patterns" class="level3">
<h3 class="anchored" data-anchor-id="genre-level-patterns">Genre-Level Patterns</h3>
<p>When we aggregate by genre, clear linguistic DNA emerges:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 27%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Genre</th>
<th>Avg TF-IDF</th>
<th>Characteristic Vocabulary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Science Fiction</strong></td>
<td>0.0089</td>
<td><code>nautilus</code>, <code>morlocks</code>, <code>meter</code>, <code>laboratory</code></td>
</tr>
<tr class="even">
<td><strong>Adventure</strong></td>
<td>0.0078</td>
<td><code>whale</code>, <code>hispaniola</code>, <code>sperm</code>, <code>pequod</code></td>
</tr>
<tr class="odd">
<td><strong>Social Fiction</strong></td>
<td>0.0053</td>
<td><code>longbourn</code>, <code>monseigneur</code>, <code>netherfield</code>, <code>garage</code></td>
</tr>
<tr class="even">
<td><strong>Fantasy</strong></td>
<td>0.0052</td>
<td><code>tootle</code>, <code>redskin</code>, <code>pirate</code>, <code>neverland</code></td>
</tr>
<tr class="odd">
<td><strong>Satirical Fiction</strong></td>
<td>0.0036</td>
<td><code>blefuscu</code>, <code>majesty</code>, <code>emperor</code>, <code>lilliput</code></td>
</tr>
<tr class="even">
<td><strong>Gothic</strong></td>
<td>0.0027</td>
<td><code>thornfield</code>, <code>whitby</code>, <code>geneva</code>, <code>dracula</code></td>
</tr>
<tr class="odd">
<td><strong>Domestic Fiction</strong></td>
<td>0.0017</td>
<td><code>rector</code>, <code>drumble</code>, <code>aunt</code>, <code>parlor</code></td>
</tr>
</tbody>
</table>
</section>
<section id="what-these-patterns-reveal" class="level3">
<h3 class="anchored" data-anchor-id="what-these-patterns-reveal">What These Patterns Reveal</h3>
<ol type="1">
<li><strong>Genre Hierarchies</strong>: Science Fiction and Adventure show the highest distinctiveness, suggesting these genres rely heavily on specialized vocabulary</li>
<li><strong>Temporal Markers</strong>: Words like <code>telephone</code>, <code>car</code>, <code>garage</code> in <em>The Great Gatsby</em> clearly mark 20th-century Social Fiction</li>
<li><strong>Setting Specificity</strong>: Geographic terms (<code>florence</code>, <code>yokohama</code>, <code>nantucket</code>) create strong textual fingerprints</li>
<li><strong>Character Integration</strong>: Names seamlessly blend with thematic vocabulary (e.g., <code>darling</code> in <em>Peter Pan</em>, <code>dracula</code> in Gothic fiction)</li>
</ol>
</section>
<section id="practical-applications" class="level3">
<h3 class="anchored" data-anchor-id="practical-applications">Practical Applications</h3>
<p>These thematic fingerprints enable:</p>
<ul>
<li><strong>Authorship Attribution</strong>: Distinctive vocabulary patterns help identify authors</li>
<li><strong>Genre Classification</strong>: Clear linguistic markers distinguish literary traditions</li>
<li><strong>Content Analysis</strong>: Specialized vocabularies reveal thematic preoccupations</li>
<li><strong>Cultural Analysis</strong>: Word choices reflect historical and social contexts</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<div class="footer-left" style="text-align: right; font-size: 0.9em; line-height: 1.5; padding: 1rem 0;">
<p style="margin: 0;">
Created by <strong><a href="https://www.library.ucsb.edu/research-data-services" target="_blank">UCSB Library Research Data Services</a></strong>
</p>
<p style="margin: 0;">
License: <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" style="text-decoration: none; color: #007BFF;">CC BY-NC 4.0</a>
</p>
<p><a href="https://doi.org/10.5281/zenodo.xxxxxxxx" style="display: inline-block; margin-top: 5px;"> <img src="https://zenodo.org/badge/DOI/10.5281/zenodo.xxxxxxxx.svg" alt="DOI" style="border: none;"> </a></p>
</div>
</div>
  </div>
</footer>




</body></html>